# бэкенд для сервиса аренды книг (AKA библиотека)
### написано в рамках тестового задания на позицию Java разработчика, условия: разработать бэкенд для библиотеки, ~~использовать JAX-RS (RestEasy или Jersey), Guice для внедрения зависмостей, JPA (Hibernate или EclipseLink), не использовать "Spring и подобные фреймворки"~~ впоследствии автор переписал все на Spring
## архитектура
* Сервис авторизации (Keycloak)
* сервис отправки OTP
* Мобильное приложение для клиентов
* Мобильное приложение для работников
* непосредственно сервис
## схема действия
1. клиент получает список книг с помощью GET /public/books
2. клиент выбирает интересующую его книгу и вызывает POST /public/books/{id}/reserve
3. бэкенд смотрит если книга есть в наличии, создает предварительную запись о выдаче книги и возвращает клиенту код выдачи
4. если клиент не заберет книгу в течение 10 минут, бронь аннулируется
5. на выдаче клиент показывает код выдачи работнику
6. работник считывает код в приложении, приложение вызывает GET /private/rentals/{id} и получает информацию о книге которую хочет получить клиент
7. работник инициирует отправку OTP клиенту POST /private/rentals/{id}/sendOtp
8. клиент получет OTP и называет его работнику
9. работник вводит код в приложение, приложение отправляет код бэкенду POST /private/rentals/{id}/confirm
10. бэкенд проверяет OTP и переводит запись о выдаче книги в статус ACTIVE, работник выдает клиенту книгу
11. клиент прочитал книгу, возвращает книгу работнику
12. работник подтверждает прием книги POST /private/rentals/{id}/close, запись переводится в статус FINISHED
13. клиент может посмотреть историю выданных книг GET /public/rentals/history
